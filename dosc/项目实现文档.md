# 项目实现文档

## 一、项目简介

本项目是一个简化的自动化助手，支持通过注册和调用不同的自动化任务（如自动收菜、自动战斗等）来实现对目标应用的自动操作。项目结构清晰，易于扩展和维护，适合个人或小团队开发自动化脚本。

------

## 二、项目结构

```
project_root/
├── src/                # 主代码目录
│   ├── SimpleController.h/.cpp  # 设备操作与图像识别核心类
│   └── main.cpp        # 程序入口，任务注册与调度
├── include/            # 头文件目录
├── resource/           # 资源文件（如模板图片、配置）
├── test/               # 测试脚本
├── docs/               # 文档说明
│   └── implementation.md  # 实现文档（本文件）
└── ...
```

------

## 三、核心模块说明

### 1. SimpleController

- 负责与设备通信（如 ADB），实现截图、点击、等待等基本操作。
- 提供同步接口，便于主流程调用。
- 可扩展支持图像识别、OCR 等功能。

### 2. 任务注册与调度

- 采用 `std::map<std::string, std::function<void(SimpleController&)>>` 结构注册自动化任务。
- 每个任务以 lambda 或函数形式实现，流程清晰，易于维护。
- 通过 key 调用对应任务，支持动态扩展。

### 3. 资源与配置

- 所有模板图片、配置参数集中存放于 resource/ 目录，便于统一管理和替换。

------

## 四、主要流程

1. 初始化 SimpleController，连接设备。
2. 注册自动化任务（如自动收菜、自动战斗等）。
3. 根据用户输入或配置选择任务。
4. 调用对应任务函数，执行自动化流程。
5. 任务执行过程中可调用截图、点击、等待等基本操作。

------

## 五、示例代码片段

```cpp
// main.cpp
SimpleController controller;
controller.connect(adb_path, address, config);

std::map<std::string, std::function<void(SimpleController&)>> task_map;
task_map["collect_crops"] = [](SimpleController& c) {
    c.click(100, 200);
    c.wait(1000);
    // ...更多操作...
};

auto user_choice = "collect_crops";
if (task_map.count(user_choice)) {
    task_map[user_choice](controller);
}
```

------

## 六、扩展建议

- 支持更多自动化任务，只需添加新的 key 和 lambda。
- 可引入配置文件（如 json/yaml）实现任务参数化。
- 后续可扩展为异步执行、任务队列、日志记录等高级功能。
- 可集成图像识别、OCR、深度学习推理等模块，提升自动化能力。

------

## 七、总结

本项目以最简化、可扩展为设计目标，采用 map+回调函数的方式管理自动化任务，主流程清晰，便于后续维护和功能扩展。适合自动化脚本开发的入门和快速原型实现。